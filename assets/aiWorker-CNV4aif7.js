(function(){"use strict";const v=(n,s,e,t,l,c)=>{if(s===0||x(n))return{score:C(n),col:-1};let i=-1;const m=w(n);if(l){i=-1;let o=-1/0;for(const r of m){const g=M(n,r,"yellow"),f=v(g,s-1,e,t,!1).score;if(f>o&&(o=f,i=r),e=Math.max(e,f),e>=t)break}return{score:o,col:i}}else{let o=1/0;i=-1;for(const r of m){const g=M(n,r,"red"),f=v(g,s-1,e,t,!0).score;if(f<o&&(o=f,i=r),t=Math.min(t,f),e>=t)break}return{score:o,col:i}}},w=n=>{const s=[];for(let e=0;e<7;e++)n[e].length<6&&s.push(e);return s},j=n=>n.every(s=>s.length===5),M=(n,s,e)=>{const t=n.map(l=>[...l]);return t[s].length<6&&t[s].push(e),t},h=(n,s)=>{for(let e=0;e<6;e++)for(let t=0;t<2;t++)if(n[e][t]==s&&n[e][t+1]==s&&n[e][t+2]==s&&n[e][t+3]==s)return!0;for(let e=0;e<3;e++)for(let t=0;t<5;t++)if(n[e][t]==s&&n[e+1][t]==s&&n[e+2][t]==s&&n[e+3][t]==s)return!0;for(let e=0;e<3;e++)for(let t=0;t<2;t++)if(n[e][t]==s&&n[e+1][t+1]==s&&n[e+2][t+2]==s&&n[e+3][t+3]==s)return!0;for(let e=0;e<3;e++)for(let t=3;t<5;t++)if(n[e][t]==s&&n[e+1][t-1]==s&&n[e+2][t-2]==s&&n[e+3][t-3]==s)return!0},x=n=>h(n,"yellow")||h(n,"red")||j(n),C=n=>{let s=0;for(let e=0;e<6;e++)for(let t=0;t<=3;t++){const l=[n[t][e],n[t+1][e],n[t+2][e],n[t+3][e]];s+=u(l)}for(let e=0;e<7;e++)for(let t=0;t<=2;t++){const l=[n[e][t],n[e][t+1],n[e][t+2],n[e][t+3]];s+=u(l)}for(let e=3;e<6;e++)for(let t=0;t<=3;t++){const l=[n[t][e],n[t+1][e-1],n[t+2][e-2],n[t+3][e-3]];s+=u(l)}for(let e=0;e<=2;e++)for(let t=0;t<=3;t++){const l=[n[t][e],n[t+1][e+1],n[t+2][e+2],n[t+3][e+3]];s+=u(l)}return s},u=n=>{let s=0;const e=n.filter(c=>c==="yellow").length,t=n.filter(c=>c==="red").length,l=n.filter(c=>!c).length;return e===4?s+=1e3:t===4?s-=1e3:e===3&&l>=1?s+=100:t===3&&l>=1?s-=100:e===2&&l>=2?s+=10:t===2&&l>=2&&(s-=10),s};self.onmessage=function(n){const{board:s,depth:e,alpha:t,beta:l,isMaximizingPlayer:c,player:i}=n.data,m=v(s,e,t,l,c);postMessage(m)}})();
